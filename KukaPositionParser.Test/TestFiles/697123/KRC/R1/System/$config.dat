&ACCESS  RV
&PARAM DISKPATH = SYSTEM
DEFDAT  $CONFIG
;FOLD BASISTECH GLOBALS
;==================================
; Default parameters for movement
; These values shouldn't be changed
;==================================

;----------------------------------
; general MOVEMENT - parameters:
;----------------------------------

INT DEF_OV_PRO=100
INT DEF_ADVANCE=3

; PTP - MOVEMENTS
;----------------------------------
INT DEF_VEL_PTP=100
INT DEF_ACC_PTP=50

; CP - MOVEMENTS                                                 
;----------------------------------
DECL CIRC_TYPE DEF_CIRC_TYP=#BASE
DECL JERK_STRUC DEF_JERK_STRUC={CP 500.000,ORI 50000.0,AX {A1 1000.00,A2 1000.00,A3 1000.00,A4 1000.00,A5 1000.00,A6 1000.00,E1 1000.00,E2 1000.00,E3 1000.00,E4 1000.00,E5 1000.00,E6 1000.00}} ; jerk value for the spline. CP: [m/Sec3], ORI: [[GRAD/Sec3], AX: [[GRAD/Sec3] (rotatory) resp. [m/Sec3] (linear)
REAL DEF_GEAR_JERK=100.000 ; gear jerk of axes [%]
REAL DEF_VEL_CP=2.00000
REAL DEF_VEL_ORI1=200.000
REAL DEF_VEL_ORI2=200.000
REAL DEF_VEL_ORIS=200.000 ; spline swivel velocity [GRAD/Sec]
REAL DEF_ACC_CP=2.30000
REAL DEF_ACC_ORI1=100.000
REAL DEF_ACC_ORI2=100.000
REAL DEF_ACC_ORIS=200.000
REAL DEF_VEL_FACT=1.00000
REAL DEF_ACC_SPTP=100.000 ; ptp spline acceleration [%]

; APO - parameters
;--------------------------------
INT DEF_APO_CPTP=50
INT DEF_APO_CVEL=100
REAL DEF_APO_CDIS=3.00000
REAL DEF_APO_CORI=5.00000
REAL DEF_APO_CORIS=80.0000 ; spline Orientation-Approximation [Grad]

;==================================
; Structures:
;==================================
ENUM BAS_COMMAND INITMOV,ACC_CP,ACC_PTP,VEL_CP,VEL_PTP,ACC_GLUE,TOOL,BASE,EX_BASE,PTP_DAT,CP_DAT,OUT_SYNC,OUT_ASYNC,GROUP,FRAMES,PTP_PARAMS,CP_PARAMS
ENUM OUT_MODETYPE TRIGGER_,CONT_,STOP_
ENUM IPO_M_T NONE,TCP,BASE
ENUM APO_MODE_T CPTP,CDIS
STRUC DIG_OUT_TYPE INT FIRST_BIT,LENGTH,PARITY,CODING
STRUC CTRL_IN_T INT IN_NR,CHAR NAME_NAT[20]
STRUC CTRL_OUT_T INT OUT_NR,BOOL INI,CHAR NAME_NAT[20]
STRUC FCT_OUT_T INT NO,REAL PULS_TIME,BOOL STATE
STRUC FCT_IN_T INT NO,BOOL STATE
STRUC PDAT REAL VEL,ACC,APO_DIST,APO_MODE_T APO_MODE,REAL GEAR_JERK,INT EXAX_IGN
STRUC LDAT REAL VEL,ACC,APO_DIST,APO_FAC,AXIS_VEL,AXIS_ACC,ORI_TYPE ORI_TYP,CIRC_TYPE CIRC_TYP,REAL JERK_FAC,GEAR_JERK,INT EXAX_IGN,CIRC_MODE CB
STRUC FDAT INT TOOL_NO,BASE_NO,IPO_MODE IPO_FRAME,CHAR POINT2[24],BOOL TQ_STATE
STRUC ODAT INT OUT_NO,BOOL STATE,REAL PULSE_TIME,OUT_MODETYPE OUT_MODE,REAL TIME_DELAY,OFFSET
STRUC BASIS_SUGG_T CHAR POINT1[24],POINT2[24],CP_PARAMS[24],PTP_PARAMS[24],CONT[24],CP_VEL[24],PTP_VEL[24],SYNC_PARAMS[24],SPL_NAME[24],A_PARAMS[24]

STRUC OUT_SUGG_T CHAR PARAMS[24]
STRUC MACHINE_DEF_T CHAR NAME[39],INT COOP_KRC_INDEX,CHAR PARENT[39],FRAME ROOT,ESYS MECH_TYPE,CHAR GEOMETRY[255]
STRUC MACHINE_TOOL_T INT MACH_DEF_INDEX,CHAR PARENT[39],CHAR GEOMETRY[255]
STRUC MACHINE_FRAME_T INT MACH_DEF_INDEX,CHAR PARENT[39],CHAR GEOMETRY[255]

STRUC TRIGGER_PARA INT TriggerPath,BOOL TriggerOnStart,INT TriggerDelay,CHAR TriggerTask[40]
STRUC CONSTVEL_PARA INT ConstVelTyp,INT ConstVelPath,BOOL ConstVelOnStart
STRUC CONDSTOP_PARA INT CondStopPath,BOOL CondStopOnStart,CHAR StopCondition[40]
STRUC ADAT TRIGGER_PARA TriggerPara,CONSTVEL_PARA ConstVelPara,CONDSTOP_PARA CondStopPara

STRUC MODULEPARAM_T CHAR PARAMS[2000]

;==================================
; TORQUE MONITORING
;==================================
SIGNAL sTQM_SPSACTIVE $IN[1026]
SIGNAL sTQM_SPSSTATUS $OUT[1024]

BOOL bTQM_ACTIVE=FALSE
BOOL bTQM_CYC=FALSE
BOOL bTQM_KCPSTATUS=FALSE

STRUC TM_SUGG_T CHAR TM_ID[24]
STRUC TQM_TQDAT_T INT T11,T12,T13,T14,T15,T16,T21,T22,T23,T24,T25,T26,K1,K2,K3,K4,K5,K6,O1,O2,ID,OVM,REAL TMF

DECL TQM_TQDAT_T TMDEFAULT={T11 200,T12 200,T13 200,T14 200,T15 200,T16 200,T21 1000,T22 1000,T23 1000,T24 1000,T25 1000,T26 1000,K1 280,K2 280,K3 280,K4 280,K5 280,K6 280,O1 20,O2 30,ID 0,OVM 0,TMF 1.00000}
DECL TQM_TQDAT_T TM0={T11 200,T12 200,T13 200,T14 200,T15 200,T16 200,T21 1000,T22 1000,T23 1000,T24 1000,T25 1000,T26 1000,K1 280,K2 280,K3 280,K4 280,K5 280,K6 280,O1 20,O2 30,ID 0,OVM 0,TMF 1.00000}

DECL TQM_TQDAT_T TQM_DATA_C[8]
DECL TQM_TQDAT_T TQM_TEMP

;==================================
; External declarations:
;==================================
EXT  BAS (BAS_COMMAND  :IN,REAL  :IN )
EXT  IR_STOPM ( )

;====================
; Signal declarations
; Do not change !!!!!
;====================
SIGNAL CHANNEL_1 $ANOUT[1]
SIGNAL CHANNEL_2 $ANOUT[2]
SIGNAL CHANNEL_3 $ANOUT[3]
SIGNAL CHANNEL_4 $ANOUT[4]
SIGNAL CHANNEL_5 $ANOUT[5]
SIGNAL CHANNEL_6 $ANOUT[6]
SIGNAL CHANNEL_7 $ANOUT[7]
SIGNAL CHANNEL_8 $ANOUT[8]
SIGNAL CHANNEL_9 $ANOUT[9]
SIGNAL CHANNEL_10 $ANOUT[10]
SIGNAL CHANNEL_11 $ANOUT[11]
SIGNAL CHANNEL_12 $ANOUT[12]
SIGNAL CHANNEL_13 $ANOUT[13]
SIGNAL CHANNEL_14 $ANOUT[14]
SIGNAL CHANNEL_15 $ANOUT[15]
SIGNAL CHANNEL_16 $ANOUT[16]
SIGNAL CHANNEL_17 $ANOUT[17]
SIGNAL CHANNEL_18 $ANOUT[18]
SIGNAL CHANNEL_19 $ANOUT[19]
SIGNAL CHANNEL_20 $ANOUT[20]
SIGNAL CHANNEL_21 $ANOUT[21]
SIGNAL CHANNEL_22 $ANOUT[22]
SIGNAL CHANNEL_23 $ANOUT[23]
SIGNAL CHANNEL_24 $ANOUT[24]
SIGNAL CHANNEL_25 $ANOUT[25]
SIGNAL CHANNEL_26 $ANOUT[26]
SIGNAL CHANNEL_27 $ANOUT[27]
SIGNAL CHANNEL_28 $ANOUT[28]
SIGNAL CHANNEL_29 $ANOUT[29]
SIGNAL CHANNEL_30 $ANOUT[30]
SIGNAL CHANNEL_31 $ANOUT[31]
SIGNAL CHANNEL_32 $ANOUT[32]

;==================================
; ID external user log-on:
;==================================
SIGNAL ExtUserID $IN[1026]  TO $IN[1026]
SIGNAL ExtUserIDWatchDog $IN[1026]

;==================================
; Variables:
;==================================
DECL PDAT PDEFAULT={VEL 100.000,ACC 50.0000,APO_DIST 100.000,APO_MODE #CDIS,GEAR_JERK 50.0000,EXAX_IGN 0}
DECL LDAT LDEFAULT={VEL 2.00000,ACC 100.000,APO_DIST 100.000,APO_FAC 50.0000,AXIS_VEL 100.000,AXIS_ACC 100.000,ORI_TYP #VAR,CIRC_TYP #BASE,JERK_FAC 50.0000,GEAR_JERK 50.0000,EXAX_IGN 0}
DECL LDAT CDEFAULT={CB {AUX_PT {ORI #CONSIDER,E1 #CONSIDER,E2 #CONSIDER,E3 #CONSIDER,E4 #CONSIDER,E5 #CONSIDER,E6 #CONSIDER},TARGET_PT {ORI #INTERPOLATE,E1 #INTERPOLATE,E2 #INTERPOLATE,E3 #INTERPOLATE,E4 #INTERPOLATE,E5 #INTERPOLATE,E6 #INTERPOLATE}}}
DECL FDAT FDEFAULT={TOOL_NO 1,BASE_NO 0,IPO_FRAME #BASE,POINT2[] " ",TQ_STATE FALSE}
DECL FDAT FHOME={TOOL_NO 1,BASE_NO 0,IPO_FRAME #BASE,POINT2[] " ",TQ_STATE FALSE}
DECL ODAT ODEFAULT={OUT_NO 1,STATE TRUE,PULSE_TIME 0.0,OUT_MODE #STOP_,TIME_DELAY 0.0,OFFSET 0.0}

DECL ADAT TDEFAULT={TriggerPara {TriggerPath 0,TriggerOnStart FALSE,TriggerDelay 0,TriggerTask[] " "}}
DECL ADAT CVDEFAULT={ConstVelPara {ConstVelTyp 0,ConstVelPath 0,ConstVelOnStart FALSE}}
DECL ADAT CSDEFAULT={CondStopPara {CondStopPath 0,CondStopOnStart FALSE,StopCondition[] " "}}

DECL PDAT PDAT_ACT
DECL LDAT LDAT_ACT
DECL FDAT FDAT_ACT
DECL ODAT ODAT_ACT
DECL INT ACT_FILTER
DECL INT ACT_DELAY
DECL INT ACT_DISTANCE

DECL CHAR SPL_NAME[24]

;GROUP-Definitions
;----------------------------------
INT COMPL_GROUP='B0001'

INT DEF_GROUP[10]
DEF_GROUP[1]='B1111' ; complete
DEF_GROUP[2]='B0001' ; robot only
DEF_GROUP[3]='B0011' ; robot and track
DEF_GROUP[4]='B0111' ; robot, track and ext. axis2
DEF_GROUP[5]='B1011' ; robot, track and ext. axis3
DEF_GROUP[6]='B1111' ; robot, track and ext. axis2+3
DEF_GROUP[7]='B1111' ; complete
DEF_GROUP[8]='B1111' ; complete
DEF_GROUP[9]='B1111' ; complete
DEF_GROUP[10]='B1111' ; complete

INT $ACT_GROUP='B0001'

; HOME POSITION
;----------------------------------
E6AXIS XHOME={A1 -68.8523712,A2 -103.480339,A3 107.390366,A4 -0.321122110,A5 86.1712875,A6 -135.996750,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
E6AXIS XHOME1={A1 -59.9405556,A2 -64.0123596,A3 72.5190887,A4 -79.7697525,A5 27.9509163,A6 90.0305786,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
E6AXIS XHOME2={A1 -64.3561630,A2 -80.5482483,A3 84.2300,A4 180.296478,A5 -86.0618,A6 -178.575165,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
E6AXIS XHOME3={A1 -48.5504,A2 -59.0385132,A3 100.705246,A4 -6.89953089,A5 46.8827,A6 -111.471085,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
E6AXIS XHOME4={A1 -68.8523712,A2 -103.480339,A3 107.390366,A4 -0.321122110,A5 86.1712875,A6 -135.996750,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
E6AXIS XHOME5={A1 -33.8955917,A2 -42.5004883,A3 70.2260284,A4 -186.850220,A5 -0.969282269,A6 181.002426,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}

; REFERENCE POINTS
;----------------------------------
DECL FRAME REF_PT[16]
REF_PT[1]={X 1367.05945,Y -97.2598419,Z -442.664032,A 0.0,B 90.0000076,C -69.8615646}
REF_PT[2]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[3]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[4]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[5]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[6]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[7]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[8]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[9]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[10]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[11]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[12]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[13]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[14]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[15]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
REF_PT[16]={X 2555.04932,Y 1302.52942,Z 944.445129,A 78.1143799,B -42.8212166,C 134.879135}

FRAME REF_TOOL={X 10.0000,Y 10.0000,Z 10.0000,A 0.0,B 0.0,C 0.0}

; TOOL and BASE data
;----------------------------------
BOOL AUTO_IPO_M=FALSE
BOOL STOPM_FLAG=TRUE
BOOL TOOL_CORR_ON=FALSE
BOOL TOOL_CORR_W_ON=FALSE
BOOL BASE_CORR_ON=FALSE
BOOL M_BAS_COR_ON=FALSE
FRAME TOOL_CORR={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
FRAME TOOL_CORR_W={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
FRAME BASE_CORR={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
FRAME M_BASE_CORR={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
INT COR_TOOL_NO=0

INT MAX_TOOL=16
DECL FRAME TOOL_DATA[16]
TOOL_DATA[1]={X -179.250,Y 329.283,Z 157.870,A 0.0,B 90.0000,C -118.000}
TOOL_DATA[2]={X 285.555084,Y -580.006165,Z 300.646179,A -1.50072575,B 67.4400558,C 88.4649582}
TOOL_DATA[3]={X 253.815079,Y -580.006165,Z 390.326172,A -1.50072575,B 67.4400558,C 88.4649582}
TOOL_DATA[4]={X 285.555084,Y -563.806,Z 300.646179,A -1.50072575,B 67.4400558,C 88.4649582}
TOOL_DATA[5]={X -0.198500,Y -667.466919,Z 305.563904,A 179.705399,B 0.000873418467,C -89.9531937}
TOOL_DATA[6]={X -0.198500,Y -667.466919,Z 305.563904,A 179.705399,B 0.000873418467,C -89.9531937}
TOOL_DATA[7]={X -0.198500,Y -667.466919,Z 305.563904,A 179.705399,B 0.000873418467,C -89.9531937}
TOOL_DATA[8]={X -0.198500,Y -667.466919,Z 305.563904,A 179.705399,B 0.000873418467,C -89.9531937}
TOOL_DATA[9]={X -94.2000,Y -687.000,Z 360.500,A 180.000,B 0.0,C -90.0000}
TOOL_DATA[10]={X 285.555084,Y -567.006165,Z 300.646179,A 0.501143,B 67.4453049,C 90.1905}
TOOL_DATA[11]={X 285.340,Y -566.140,Z 300.660,A 1.00000,B 67.5000,C 90.0000}
TOOL_DATA[12]={X 285.340,Y -566.140,Z 300.660,A 2.88784623,B 68.6895065,C 91.7532272}
TOOL_DATA[13]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
TOOL_DATA[14]={X -94.2000,Y -687.000,Z 360.500,A 179.705399,B 0.000873418467,C -89.9531937}
TOOL_DATA[15]={X 285.555084,Y -589.505,Z 300.877,A -1.50072575,B 67.4400558,C 88.4649582}
TOOL_DATA[16]={X 4.20200,Y -8.17000,Z 628.342,A -84.7860,B -17.7300,C -14.0830}

DECL CHAR TOOL_NAME[16,24]
TOOL_NAME[1,]="laser"
TOOL_NAME[2,]="Tool1"
TOOL_NAME[3,]="TELEMETER"
TOOL_NAME[4,]="Tool"
TOOL_NAME[5,]="Tool"
TOOL_NAME[6,]="Tool"
TOOL_NAME[7,]="Tool"
TOOL_NAME[8,]="Tool"
TOOL_NAME[9,]="Tool"
TOOL_NAME[10,]="Tool"
TOOL_NAME[11,]="Tool"
TOOL_NAME[12,]="Tool"
TOOL_NAME[13,]=" "
TOOL_NAME[14,]="Tool"
TOOL_NAME[15,]="Leoni_Working"
TOOL_NAME[16,]="SERVO_ROBOT"

DECL LOAD LOAD_DATA[16]
LOAD_DATA[1]={M 35.0000,CM {X 180.000,Y 0.0,Z 150.000,A 0.0,B 0.0,C 0.0},J {X 10.5000,Y 10.5000,Z 10.5000}}
LOAD_DATA[2]={M 220.441,CM {X 114.201,Y -81.5990,Z 242.321,A 89.1630,B -0.569000,C 1.12300},J {X 12.4600,Y 18.6940,Z 35.6060}}
LOAD_DATA[3]={M 220.441101,CM {X 114.200912,Y -81.5991,Z 242.321,A 89.1628571,B -0.568609,C 1.12347698},J {X 12.4596491,Y 18.6944141,Z 35.6057396}}
LOAD_DATA[4]={M 220.441101,CM {X 114.200912,Y -81.5991,Z 242.321,A 89.1628571,B -0.568609,C 1.12347698},J {X 12.4596491,Y 18.6944141,Z 35.6057396}}
LOAD_DATA[5]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[6]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[7]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[8]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[9]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[10]={M 220.441101,CM {X 114.200912,Y -81.5991,Z 242.321,A 89.1628571,B -0.568609,C 1.12347698},J {X 12.4596491,Y 18.6944141,Z 35.6057396}}
LOAD_DATA[11]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[12]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[13]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[14]={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
LOAD_DATA[15]={M 210.000,CM {X 270.000,Y 0.0,Z 210.000,A 0.0,B 0.0,C 0.0},J {X 105.000,Y 105.000,Z 105.000}}
LOAD_DATA[16]={M 1.00000,CM {X 270.000,Y 0.0,Z 210.000,A 0.0,B 0.0,C 0.0},J {X 105.000,Y 105.000,Z 105.000}}

DECL IPO_M_T TOOL_TYPE[16]
TOOL_TYPE[1]=#BASE
TOOL_TYPE[2]=#BASE
TOOL_TYPE[3]=#BASE
TOOL_TYPE[4]=#BASE
TOOL_TYPE[5]=#BASE
TOOL_TYPE[6]=#BASE
TOOL_TYPE[7]=#BASE
TOOL_TYPE[8]=#BASE
TOOL_TYPE[9]=#BASE
TOOL_TYPE[10]=#BASE
TOOL_TYPE[11]=#BASE
TOOL_TYPE[12]=#BASE
TOOL_TYPE[13]=#NONE
TOOL_TYPE[14]=#BASE
TOOL_TYPE[15]=#BASE
TOOL_TYPE[16]=#BASE

DECL LOAD LOAD_A1_DATA={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
DECL LOAD LOAD_A2_DATA={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}
DECL LOAD LOAD_A3_DATA={M -1.00000,CM {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},J {X 0.0,Y 0.0,Z 0.0}}

INT MAX_BASE=32
DECL FRAME BASE_DATA[32]
BASE_DATA[1]={X 1524.16699,Y 736.772400,Z -615.235413,A 42.6572,B 3.22240,C 1.38410}
BASE_DATA[2]={X 1000.59198,Y -2317.54,Z 1235.00903,A -90.0000,B -50.8343,C 0.0}
BASE_DATA[3]={X 2269.28101,Y -696.514282,Z 1209.94897,A -92.9405,B -32.8376,C 1.18240}
BASE_DATA[4]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[5]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[6]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[7]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[8]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[9]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[10]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[11]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[12]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[13]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[14]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[15]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[16]={X -7.10310698,Y -5.73405218,Z -6.62285185,A 0.123131059,B -0.288276941,C 0.138922438}
BASE_DATA[17]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[18]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[19]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[20]={X 284.561615,Y -565.516174,Z 301.063965,A 2.90640759,B 68.6558685,C 91.7150650}
BASE_DATA[21]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[22]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[23]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[24]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[25]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[26]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[27]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[28]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[29]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[30]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[31]={X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0}
BASE_DATA[32]={X 1882.27905,Y -790.113770,Z -765.534119,A 10.1170,B 89.6409,C -41.4578}

DECL CHAR BASE_NAME[32,24]
BASE_NAME[1,]="cell"
BASE_NAME[2,]="RIGHT_DOME_CONE"
BASE_NAME[3,]="Base"
BASE_NAME[4,]=" "
BASE_NAME[5,]=" "
BASE_NAME[6,]=" "
BASE_NAME[7,]=" "
BASE_NAME[8,]=" "
BASE_NAME[9,]=" "
BASE_NAME[10,]=" "
BASE_NAME[11,]=" "
BASE_NAME[12,]=" "
BASE_NAME[13,]=" "
BASE_NAME[14,]=" "
BASE_NAME[15,]=" "
BASE_NAME[16,]="Base"
BASE_NAME[17,]=" "
BASE_NAME[18,]=" "
BASE_NAME[19,]=" "
BASE_NAME[20,]="Base"
BASE_NAME[21,]=" "
BASE_NAME[22,]=" "
BASE_NAME[23,]=" "
BASE_NAME[24,]=" "
BASE_NAME[25,]=" "
BASE_NAME[26,]=" "
BASE_NAME[27,]=" "
BASE_NAME[28,]=" "
BASE_NAME[29,]=" "
BASE_NAME[30,]=" "
BASE_NAME[31,]=" "
BASE_NAME[32,]="Leoni_Master"

DECL IPO_M_T BASE_TYPE[32]
BASE_TYPE[1]=#BASE
BASE_TYPE[2]=#BASE
BASE_TYPE[3]=#BASE
BASE_TYPE[4]=#NONE
BASE_TYPE[5]=#NONE
BASE_TYPE[6]=#NONE
BASE_TYPE[7]=#NONE
BASE_TYPE[8]=#NONE
BASE_TYPE[9]=#NONE
BASE_TYPE[10]=#NONE
BASE_TYPE[11]=#NONE
BASE_TYPE[12]=#NONE
BASE_TYPE[13]=#NONE
BASE_TYPE[14]=#NONE
BASE_TYPE[15]=#NONE
BASE_TYPE[16]=#BASE
BASE_TYPE[17]=#NONE
BASE_TYPE[18]=#NONE
BASE_TYPE[19]=#NONE
BASE_TYPE[20]=#BASE
BASE_TYPE[21]=#NONE
BASE_TYPE[22]=#NONE
BASE_TYPE[23]=#NONE
BASE_TYPE[24]=#NONE
BASE_TYPE[25]=#NONE
BASE_TYPE[26]=#NONE
BASE_TYPE[27]=#NONE
BASE_TYPE[28]=#NONE
BASE_TYPE[29]=#NONE
BASE_TYPE[30]=#NONE
BASE_TYPE[31]=#NONE
BASE_TYPE[32]=#BASE

;******************************************
; Variables for CELL DEFINITION
;******************************************

INT MAX_MACHINES=16
DECL MACHINE_DEF_T MACHINE_DEF[16]
MACHINE_DEF[1]={NAME[] "KR 30-3",COOP_KRC_INDEX 1,PARENT[] "WORLD",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #ROBOT,GEOMETRY[] "ObjectId = -25367396"}
MACHINE_DEF[2]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[3]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[4]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[5]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[6]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[7]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[8]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[9]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[10]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[11]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[12]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[13]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[14]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[15]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}
MACHINE_DEF[16]={NAME[] " ",COOP_KRC_INDEX 0,PARENT[] " ",ROOT {X 0.0,Y 0.0,Z 0.0,A 0.0,B 0.0,C 0.0},MECH_TYPE #NONE,GEOMETRY[] " "}

DECL MACHINE_TOOL_T MACHINE_TOOL_DAT[16]
MACHINE_TOOL_DAT[1]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[2]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[3]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[4]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[5]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[6]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[7]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[8]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[9]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[10]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[11]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[12]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[13]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_TOOL_DAT[14]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[15]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}
MACHINE_TOOL_DAT[16]={MACH_DEF_INDEX 1,PARENT[] "KR 30-3",GEOMETRY[] " "}

DECL MACHINE_FRAME_T MACHINE_FRAME_DAT[32]
MACHINE_FRAME_DAT[1]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}
MACHINE_FRAME_DAT[2]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}
MACHINE_FRAME_DAT[3]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}
MACHINE_FRAME_DAT[4]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[5]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[6]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[7]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[8]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[9]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[10]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[11]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[12]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[13]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[14]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[15]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[16]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}
MACHINE_FRAME_DAT[17]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[18]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[19]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[20]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}
MACHINE_FRAME_DAT[21]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[22]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[23]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[24]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[25]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[26]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[27]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[28]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[29]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[30]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[31]={MACH_DEF_INDEX 0,PARENT[] " ",GEOMETRY[] " "}
MACHINE_FRAME_DAT[32]={MACH_DEF_INDEX 0,PARENT[] "WORLD",GEOMETRY[] " "}

;******************************************
; Variables for axis CALIBRATING
;******************************************
DECL INT CAL_AXIS
BOOL CONST_SPEED

;******************************************
; Variables for added TechPackages
;******************************************
INT POWER

;******************************************
; General purpose return value of functions
; like INVERSE, FORWARD
;******************************************
INT ERR_STATUS=-1

;******************************************
; Variables for TOUCHUP user limit 
;******************************************
BOOL UM_TOUCHUP=FALSE
REAL CARTESIAN_TOL=5.00000
REAL ROTATION_ANGLE=10.0000
REAL EXTAX_TOL[6]
EXTAX_TOL[1]=10.0000
EXTAX_TOL[2]=10.0000
EXTAX_TOL[3]=10.0000
EXTAX_TOL[4]=10.0000
EXTAX_TOL[5]=10.0000
EXTAX_TOL[6]=10.0000

;******************************************
; Variables for Displaying and Konfiguring
;******************************************
DECL INT I[20]

I[1]=0
I[2]=0
I[3]=0
I[4]=0
I[5]=0
I[6]=0
I[7]=0
I[8]=0
I[9]=0
I[10]=0
I[11]=0
I[12]=0
I[13]=0
I[14]=0
I[15]=0
I[16]=0
I[17]=0
I[18]=0
I[19]=0
I[20]=2000000000

;******************************************
; all for InterBus Mapping on optional segments
;******************************************

DECL INT IBUS_SEGMENT[16]
IBUS_SEGMENT[1]=0
IBUS_SEGMENT[2]=0
IBUS_SEGMENT[3]=0
IBUS_SEGMENT[4]=0
IBUS_SEGMENT[5]=0
IBUS_SEGMENT[6]=0
IBUS_SEGMENT[7]=0
IBUS_SEGMENT[8]=0
IBUS_SEGMENT[9]=0
IBUS_SEGMENT[10]=0
IBUS_SEGMENT[11]=0
IBUS_SEGMENT[12]=0
IBUS_SEGMENT[13]=0
IBUS_SEGMENT[14]=0
IBUS_SEGMENT[15]=0
IBUS_SEGMENT[16]=0

;******************************************
; Reduction factors
;******************************************
DECL REAL RedVelExAx[6]
RedVelExAx[1]=100.000
RedVelExAx[2]=100.000
RedVelExAx[3]=100.000
RedVelExAx[4]=100.000
RedVelExAx[5]=100.000
RedVelExAx[6]=100.000
DECL REAL RedAccExAx[6]
RedAccExAx[1]=100.000
RedAccExAx[2]=100.000
RedAccExAx[3]=100.000
RedAccExAx[4]=100.000
RedAccExAx[5]=100.000
RedAccExAx[6]=100.000
;ENDFOLD (BASISTECH GLOBALS)
;FOLD AUTOEXT GLOBALS
;==================================
; Structures:
;==================================
ENUM FUNCT_TYPE PGNO_GET,PGNO_ACKN,PGNO_FAULT
ENUM P00_COMMAND INIT_EXT,EXT_PGNO,CHK_HOME,EXT_ERR

STRUC SPS_PROG_TYPE INT PROG_NR,CHAR PROG_NAME[12]
;==================================
; External declarations:
;==================================
EXT  P00 (P00_COMMAND  :IN,FUNCT_TYPE  :IN,CHAR [] :OUT,INT  :IN )
;External declaration  for  Submit controlled AutoExt
EXT  P00_SUBM (P00_COMMAND  :IN,FUNCT_TYPE  :IN )

;==================================
; Variables:
;==================================
; Variables for internal
; Communication:
;----------------------------------
BOOL ERROR_FLAG
BOOL CHECK_HOME=TRUE
BOOL PROG_CONTROL=FALSE
DECL CHAR PRO_NAME1_L[8]
PRO_NAME1_L[]="        "
DECL CHAR PRO_NAME1_A[8]
PRO_NAME1_A[]="        "

INT PGNO=1 ;copy of ext. pgno
INT PGNO_ERROR=0 ;transmission error
INT PGNO_TYPE=1 ;coding type of ext. pgno
INT REFLECT_PROG_NR=1 ; enable mirroring of program number inputs (1=enabled, 0=disabled)

; Variables for External 
; Communication: I/O-Interface
;----------------------------------
INT PGNO_FBIT=9 ;first bit of ext. pgno input $IN[]
INT PGNO_FBIT_REFL=9 ;first bit of ext. pgno reflection output $OUT[]
INT PGNO_LENGTH=8 ;length of ext. pgno (max. 16)
INT PGNO_PARITY=0 ;parity bit of ext. pgno
INT PGNO_REQ=17 ;request ext. pgno input
INT PGNO_VALID=17 ;validate ext. pgno input
INT APPL_RUN=0 ;application program is running output
INT ERR_TO_PLC=35 ;error output to PLC
INT P01_STEP
INT CHK_STEP
INT PGNO_FLAG

; Table for assign SPS program number to program name
INT MAX_SPS_PROG=12
DECL SPS_PROG_TYPE SPS_PROG[12]
SPS_PROG[1]={PROG_NR 1,PROG_NAME[] "HP01()    "}
SPS_PROG[2]={PROG_NR 2,PROG_NAME[] "HP02()    "}
SPS_PROG[3]={PROG_NR 3,PROG_NAME[] "HP03()    "}
SPS_PROG[4]={PROG_NR 4,PROG_NAME[] "HP04()    "}
SPS_PROG[5]={PROG_NR 5,PROG_NAME[] "HP05()    "}
SPS_PROG[6]={PROG_NR 6,PROG_NAME[] "HP06()    "}
SPS_PROG[7]={PROG_NR 7,PROG_NAME[] "HP07()    "}
SPS_PROG[8]={PROG_NR 8,PROG_NAME[] "HP08()    "}
SPS_PROG[9]={PROG_NR 9,PROG_NAME[] "HP09()    "}
SPS_PROG[10]={PROG_NR 10,PROG_NAME[] "HP10()    "}
SPS_PROG[11]={PROG_NR 62,PROG_NAME[] "HP62()    "}
SPS_PROG[12]={PROG_NR 63,PROG_NAME[] "HP63()    "}
DECL CHAR TMPNAME[128]
TMPNAME[]="                                "
;ENDFOLD (AUTOEXT GLOBALS)
;FOLD BackupManagerConfig
BOOL BM_ENABLED
INT BM_OUTPUTVALUE
SIGNAL BM_OutputSignal $OUT[4095]  TO $OUT[4096]
SIGNAL BM_InputSignal $IN[1026]  TO $IN[1026]
;ENDFOLD BackupManagerConfig
;FOLD Conveyor
DECL INT CONV_PART_NBR[16]
CONV_PART_NBR[1]=0
CONV_PART_NBR[2]=0
CONV_PART_NBR[3]=0
CONV_PART_NBR[4]=0
CONV_PART_NBR[5]=0
CONV_PART_NBR[6]=0
CONV_PART_NBR[7]=0
CONV_PART_NBR[8]=0
CONV_PART_NBR[9]=0
CONV_PART_NBR[10]=0
CONV_PART_NBR[11]=0
CONV_PART_NBR[12]=0
CONV_PART_NBR[13]=0
CONV_PART_NBR[14]=0
CONV_PART_NBR[15]=0
CONV_PART_NBR[16]=0
;ENDFOLD Conveyor

;FOLD TeslaCore
;ENDFOLD (TeslaCore)
;FOLD USER GLOBALS
;*******************************************
;Make your modifications -ONLY- here
;*******************************************
;==================================
; Userdefined Types 
;==================================

;==================================
; Userdefined Externals 
;==================================

;==================================
; Userdefined Variables 
;==================================
DECL E6POS leftConeStartPoint={X -2694.19702,Y -791.886353,Z 940.827515,A 90.4752884,B 2.20473027,C 96.5459061,S 2,T 11,E1 0.0,E2 0.0,E3 0.0,E4 0.0,E5 0.0,E6 0.0}
DECL REAL LeftConeTargetPosX=-1.81400
DECL REAL LeftConeTargetPosZ=129.901
DECL REAL targetPosOffsetX=0.0
DECL REAL targetPosOffsetZ=0.0

SIGNAL O_BrakeTestRequired $OUT[1049]
SIGNAL O_MasRefRequired $OUT[1050]
SIGNAL O_RunningFromCell $OUT[1051]
DECL E6POS Xdummy_point

DECL E6POS barrelPosAux

;Backing bar limits
DECL REAL bottomRightZ=2146.79
DECL REAL bottomRightY=-309.590
DECL REAL topLeftZ=2162.66
DECL REAL topLeftY=-287.490

SIGNAL barrelDistanceRaw $IN[5201]  TO $IN[5232]
DECL REAL barrelDistanceX

SIGNAL seamPositionRaw $IN[5233]  TO $IN[5264]
DECL REAL seamOffsetZ

SIGNAL weldActive $IN[174]
SIGNAL doneAdjusting $IN[5047]


SIGNAL barrelMoveDirection $IN[169]
SIGNAL seamMoveDirection $IN[173]


SIGNAL actualHeightOffsetRaw $IN[5329]  TO $IN[5360]
DECL REAL actualHeightOffset

SIGNAL actualSeamOffsetRaw $IN[5361]  TO $IN[5392]
DECL REAL actualSeamOffset=-2.55000
SIGNAL actualSeamPosRaw $OUT[5329]  TO $OUT[5360]

SIGNAL actualHeightPosRaw $OUT[5361]  TO $OUT[5392]

SIGNAL programComplete $OUT[162]

SIGNAL barrelInitalPos $OUT[165]
SIGNAL barrelFound $OUT[166]
SIGNAL findBarrel $IN[166]
SIGNAL findSeam $IN[170]
SIGNAL seamFound $OUT[170]

SIGNAL barrelDistanceOk $IN[171]
SIGNAL seamDataOk $IN[172]



SIGNAL heightInDistance $IN[5043]
SIGNAL seamInDistance $IN[5044]


SIGNAL goIn $IN[5045]
SIGNAL goOut $IN[5046]



; 2021-09-01
DECL REAL sc_distance_offset

; Seam tracking adjustments limits
; When a seam is found limit how far we can go up and down (Z)

; Limit
DECL REAL maxSeamAdjSP=2.00000

; Upper and lower limit
DECL REAL maxSeamValueZ
DECL REAL minSeamValueZ

SIGNAL seamMaxLimit $OUT[171]
SIGNAL seamMinLimit $OUT[172]

; seam tracking disabled
SIGNAL jogUPSEAM $IN[175]
SIGNAL jogDOWNSEAM $IN[176]
SIGNAL jogAck $IN[177]

SIGNAL jogDone $OUT[173]

SIGNAL seamTrackDisabled $IN[178]
; Seam tracking adjustments limits
; When a seam is found limit how far we can go up and down (Z)


; seam tracking disabled 


SIGNAL VIS_Pos $IN[5201]  TO $IN[5232]
SIGNAL VIS_Height $IN[5233]  TO $IN[5264]
SIGNAL VIS_C_Angle $IN[5265]  TO $IN[5296]
SIGNAL VIS_HeightNearTorch $IN[5297]  TO $IN[5328]

SIGNAL VIS_HtNrTrch_TARGET_PLC $IN[5489]  TO $IN[5520]

SIGNAL VIS_Pos_Target_PLC $IN[5521]  TO $IN[5552]
SIGNAL VIS_Height_Target_PLC $IN[5553]  TO $IN[5584]
SIGNAL VIS_C_Angle_Target_PLC $IN[5585]  TO $IN[5616]

SIGNAL SICK_ScannerConnected $IN[5119]
SIGNAL RSI_Z_Signal_Select $IN[5120]
SIGNAL ME_ScannerConnected $IN[5121]
SIGNAL RSI_MoveCorr_Stop_PLC $IN[5122]
SIGNAL RSI_X_Disable_PLC $IN[5123]
SIGNAL RSI_Y_Disable_PLC $IN[5124]
SIGNAL RSI_Z_Disable_PLC $IN[5125]
SIGNAL RSI_A_Disable_PLC $IN[5126]
SIGNAL RSI_B_Disable_PLC $IN[5127]
SIGNAL RSI_C_Disable_PLC $IN[5128]
SIGNAL RSI_RESET_ALL_PIDS $IN[5112]
SIGNAL RSI_RESET_X_PID $IN[5113]
SIGNAL RSI_RESET_Y_PID $IN[5114]
SIGNAL RSI_RESET_Z_PID $IN[5115]
SIGNAL RSI_RESET_A_PID $IN[5116]
SIGNAL RSI_RESET_B_PID $IN[5117]
SIGNAL RSI_RESET_C_PID $IN[5118]
SIGNAL RSI_GO_MANUAL $IN[5111]

SIGNAL ROBOT_POS_X $OUT[5201]  TO $OUT[5232]
SIGNAL ROBOT_POS_Y $OUT[5233]  TO $OUT[5264]
SIGNAL ROBOT_POS_Z $OUT[5265]  TO $OUT[5296]
SIGNAL ROBOT_POS_A $OUT[5297]  TO $OUT[5328]
SIGNAL ROBOT_POS_B $OUT[5329]  TO $OUT[5360]
SIGNAL ROBOT_POS_C $OUT[5361]  TO $OUT[5392]

SIGNAL ROBOT_FRAME_X $OUT[5393]  TO $OUT[5424]
SIGNAL ROBOT_FRAME_Y $OUT[5425]  TO $OUT[5456]
SIGNAL ROBOT_FRAME_Z $OUT[5457]  TO $OUT[5488]
SIGNAL ROBOT_FRAME_A $OUT[5489]  TO $OUT[5520]
SIGNAL ROBOT_FRAME_B $OUT[5521]  TO $OUT[5552]
SIGNAL ROBOT_FRAME_C $OUT[5553]  TO $OUT[5584]

SIGNAL PLC_PID_UPDATE $IN[5050]
SIGNAL PLC_PID_Indx $IN[5193]  TO $IN[5200]
SIGNAL PLC_PID_P $IN[5361]  TO $IN[5392]
SIGNAL PLC_PID_I $IN[5393]  TO $IN[5424]
SIGNAL PLC_PID_D $IN[5425]  TO $IN[5456]

SIGNAL PLC_PID_ECHO_Indx $OUT[5129]  TO $OUT[5136]
SIGNAL PLC_PID_ECHO_P $OUT[4865]  TO $OUT[4896]
SIGNAL PLC_PID_ECHO_I $OUT[4897]  TO $OUT[4928]
SIGNAL PLC_PID_ECHO_D $OUT[4929]  TO $OUT[4960]
SIGNAL PLC_PID_ECHO_LwrLim $OUT[4961]  TO $OUT[4992]
SIGNAL PLC_PID_ECHO_UprLim $OUT[4993]  TO $OUT[5024]




DECL INT RSI_ID=199377120
DECL REAL VIS_HEIGHT_TO_B_ANGLE=0.344828

DECL INT VIS_HEIGHT_NOT_IN_RANGE=32232
DECL REAL VIS_HEIGHT_TARGET=0.0
DECL REAL VIS_X_TARGET=0.0
DECL REAL VIS_POS_TARGET=0.0
DECL REAL VIS_A_ANGLE_TARGET=0.0
DECL REAL VIS_B_ANGLE_TARGET=0.0
DECL REAL VIS_C_ANGLE_TARGET=0.0


DECL INT RSI_Sys_Disable=1 ;SEN_PINT[] index 
DECL INT RSI_x_Sys_Disable=2 ;SEN_PINT[] index 
DECL INT RSI_Y_Sys_Disable=3 ;SEN_PINT[] index 
DECL INT RSI_Z_Sys_Disable=4 ;SEN_PINT[] index 
DECL INT RSI_A_Sys_Disable=5 ;SEN_PINT[] index 
DECL INT RSI_B_Sys_Disable=6 ;SEN_PINT[] index 
DECL INT RSI_C_Sys_Disable=7 ;SEN_PINT[] index 
DECL INT RSI_MoveCorr_Stop=8 ;SEN_PINT[] index 
DECL INT RSI_MoveCorr_COUNTDOWN=9 ;SEN_PINT[] index 



DECL INT PID_Indx_X=1
DECL INT PID_Indx_Y=2
DECL INT PID_Indx_Z=3
DECL INT PID_Indx_A=4
DECL INT PID_Indx_B=5
DECL INT PID_Indx_C=6
DECL CHAR PID_NAMES[6,24]
PID_NAMES[1,]="VIS_Pos_PID"
PID_NAMES[2,]="VIS_X_PID"
PID_NAMES[3,]="VIS_Dist_Height_PID"
PID_NAMES[4,]="VIS_A_Angle_PID"
PID_NAMES[5,]="VIS_B_Angle_PID"
PID_NAMES[6,]="VIS_C_Angle_PID"

STRUC PID_SETTINGS_TYPE REAL P,I,D,LwrLim,UprLim
DECL PID_SETTINGS_TYPE GuidancePids[6]

GuidancePids[1]={P 11.0000,I 4.00000,D 0.0,LwrLim -0.0250000,UprLim 0.0250000}
GuidancePids[2]={P 20.4800,I 1.00000,D 1.00000,LwrLim -1.00000E-04,UprLim 1.00000E-04}
GuidancePids[3]={P 24.0000,I 0.0,D 0.0,LwrLim -0.0250000,UprLim 0.0250000}
GuidancePids[4]={P 8.00000,I 4.00000,D 0.0,LwrLim -0.0250000,UprLim 0.0250000}
GuidancePids[5]={P 9.00000,I 14.0000,D 0.0,LwrLim -0.0600000,UprLim 0.0500000}
GuidancePids[6]={P 8.00000,I 4.00000,D 0.0,LwrLim -0.0500000,UprLim 0.0500000}

DECL BOOL RSI_ACTIVE=FALSE

DECL REAL RSI_XPid_P=11.0000
DECL REAL RSI_XPid_I=4.00000
DECL REAL RSI_XPid_D=0.0
DECL REAL RSI_XPid_LwrLim=-0.0250000
DECL REAL RSI_XPid_UprLim=0.0250000

DECL REAL RSI_YPid_P=8.00000
DECL REAL RSI_YPid_I=1.00000
DECL REAL RSI_YPid_D=1.00000
DECL REAL RSI_YPid_LwrLim=-1.00000E-04
DECL REAL RSI_YPid_UprLim=1.00000E-04

DECL REAL RSI_ZPid_P=26.0000
DECL REAL RSI_ZPid_I=1.20000
DECL REAL RSI_ZPid_D=0.0
DECL REAL RSI_ZPid_LwrLim=-0.0250000
DECL REAL RSI_ZPid_UprLim=0.0250000


DECL REAL RSI_APid_P=8.00000
DECL REAL RSI_APid_I=4.00000
DECL REAL RSI_APid_D=0.0
DECL REAL RSI_APid_LwrLim=-0.0500000
DECL REAL RSI_APid_UprLim=0.0500000

DECL REAL RSI_BPid_P=9.00000
DECL REAL RSI_BPid_I=14.0000
DECL REAL RSI_BPid_D=0.0
DECL REAL RSI_BPid_LwrLim=-0.0600000
DECL REAL RSI_BPid_UprLim=0.0500000

DECL REAL RSI_CPid_P=8.00000
DECL REAL RSI_CPid_I=4.00000
DECL REAL RSI_CPid_D=0.0
DECL REAL RSI_CPid_LwrLim=-0.0500000
DECL REAL RSI_CPid_UprLim=0.0500000




;ENDFOLD (USER GLOBALS)
ENDDAT
